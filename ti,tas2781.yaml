# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
# Copyright (C) 2022 Texas Instruments Incorporated
%YAML 1.2
---
$id: http://devicetree.org/schemas/sound/ti,tas2781.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Texas Instruments TAS2781 Smart PA

maintainers:
  - Shenghao Ding <shenghao-ding@ti.com>
  - Kevin Lu <kevin-lu@ti.com>

description: |
  The TAS2781 is a mono, digital input Class-D audio amplifier
  optimized for efficiently driving high peak power into small
  loudspeakers. Integrated an on-chip DSP supports Texas Instruments
  Smart Amp speaker protection algorithm. The integrated speaker
  voltage and current sense provides for real time
  monitoring of loudspeaker behavior.

properties:
  compatible:
    enum:
      - ti,tas2781

  reg:
    maxItems: 1
    description: |
      I2C address of the device can be in range from 0x38 to 0x40.

  ti,audio-slots:
    $ref: /schemas/types.yaml#/definitions/uint32-array
    minItems: 1
    maxItems: 4
    description: |
      This item is used to store the i2c address of the device
      for deifferent audio slots. It is not required for Mono case.

  ti,global-addr:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: |
      This item is used to store the generic i2c address of
      all the tas2781 devices for I2C broadcast during the multi-device
      writes, useless in mono case.

  ti,reset-gpios:
    minItems: 1
    maxItems: 4
    description: GPIO specifier for the reset pin.

  ti,irq-gpio:
    maxItems: 1
    description: GPIO used to interrupts the device.

  '#sound-dai-cells':
    const: 1

required:
  - compatible
  - reg

additionalProperties: false

examples:
  - |
   #include <dt-bindings/gpio/gpio.h>
   i2c {
     /* example with mono support */
     #address-cells = <1>;
     #size-cells = <0>;
     mono: codec@38 {
       compatible = "ti,tas2781";
       reg = <0x38>;
       #sound-dai-cells = <1>;
       ti,reset-gpios = <&gpio1 10 GPIO_ACTIVE_HIGH>;
       ti,irq-gpio = <&gpio1 15 0>;
     };
   };
  - |
   #include <dt-bindings/gpio/gpio.h>
   i2c {
     /* Stereo without irq-gpio and global-addr */
     #address-cells = <1>;
     #size-cells = <0>;
     stereo: codec@38 {
       compatible = "ti,tas2781";
       reg = <0x38>;
       #sound-dai-cells = <1>;
       ti,audio-slots = < 0x38 /* left-channel */
                          0x39 /* right-channel */
                        >;
       ti,reset-gpios = < &gpio1 10 GPIO_ACTIVE_HIGH
                          &gpio1 11 GPIO_ACTIVE_HIGH
                        >;
     };
   };
  - |
   #include <dt-bindings/gpio/gpio.h>
   i2c {
     /* example with quad support, such as tablet or pad device */
     #address-cells = <1>;
     #size-cells = <0>;
     quad: codec@38 {
       compatible = "ti,tas2781";
       reg = <0x38>;
       #sound-dai-cells = <1>;
       ti,audio-slots = < 0x38 /* topleft-channel */
                          0x39 /* topright-channel */
                          0x3a /* bottomleft-channel */
                          0x3b /* bottomright-channel */
                        >;
       ti,global-addr = <0x40>;
       ti,reset-gpios = < &gpio1 10 GPIO_ACTIVE_HIGH
                          &gpio1 11 GPIO_ACTIVE_HIGH
                          &gpio1 12 GPIO_ACTIVE_HIGH
                          &gpio1 13 GPIO_ACTIVE_HIGH
                        >;
       ti,irq-gpio = <&gpio1 15 0>;
     };
   };
...
