Regbin Tool User Guideline

TI Information
Information –
– Selective
Selective Disclosure
Disclosure
TI

Revision history
Ver

Date

Author

Description

1.0

2020/07/18

Initial

1.1

2021/3/8

Review revision

1.2

2023/7/25

Support 1.3.6

1.3

2023/10/9

Add how to convert Jason
file to bin file

1.4

2024/1/1

Add regbin_parser.exe &
parsing-tool.bat

TI Information – Selective Disclosure

1/3/2024
2

Content
• Regbin file Introduction

• Bin file making
• How to use
• Applied cases
• To be Improved

TI Information – Selective Disclosure

Regbin file
• Register setting can be provided via a single file
– No Software change for register setting change
– Holds the entire set of application register setting for some special cases
– Control multiple devices freely
– applied in the chip pre-poweron, post-poweron, pre-poweroff and post-poweroff
– For read-only use in an embedded system
• The bin file is read only once during system bootup

– Information in header for customer application description, such as platform vendor,
chip type, chip quantity, etc.

TI Information – Selective Disclosure

Motivation
• There is a single file to share
– between phone and development + debug environment
– between peers and customers

• Helps to improve reproducibly
– Version can be embedded in the file
– Benefit for issue debug

• A step to reduce dependency on code build
– Limit SW build dependency in the loop for AE debugging

• eg: In 4-slot TDM bring-up, it can save much time in building if reg-bin solution is
ready at that time.

TI Information – Selective Disclosure

Bin File Making I | Startup Regbin tool

TI Information – Selective Disclosure

6

Bin File Making II | Select Device Type

TI Information – Selective Disclosure

7

Bin File Making III | Select Platform

TI Information – Selective Disclosure

8

Bin File Making IV | Select Number of Devices

TI Information – Selective Disclosure

Bin File Making V | Select Device type

TI Information – Selective Disclosure

10

Bin File Making VI | Configuration Page

Config Page is displayed
successfully on clicking Next in
hardware setup page

TI Information – Selective Disclosure

Bin File Making VII | Add Configuration

Configurations can be added
successfully on clicking the “+”
icon in the configurations box

TI Information – Selective Disclosure

Bin File Making VIII | Rename Configuration name

TI Information – Selective Disclosure

13

Bin File Making IX | Copy Configuration

TI Information – Selective Disclosure

14

Bin File Making X | Delete Configuration

TI Information – Selective Disclosure

Bin File Making XI | Delete Last Configuration

TI Information – Selective Disclosure

Bin File Making XII | Add Blocks

Blocks can be added
successfully on clicking the “+”
icon in the Blocks box

TI Information – Selective Disclosure

Bin File Making XIII | Select Block Type
• The driver only support
PRE_POWER_UP for chip power up,
and PRE_SHUTDOWN for chip
shutdown.

TI Information – Selective Disclosure

18

Bin File Making XIV | Select Device for one specific Block
• “Common” means all the devices
defined in the regbin file, for the right
picture, the common means both dev 1
and dev 2.

TI Information – Selective Disclosure

19

Bin File Making XV | Delete Block

TI Information – Selective Disclosure

Bin File Making XVI | Delete Last Block in Configuration

TI Information – Selective Disclosure

Bin File Making XVI | Add First Command

First command can be added
successfully on clicking the “Add
First Command” button

TI Information – Selective Disclosure

Bin File Making XVII | Bulk write/Burst commands
• If writing BOOK0x00, PAGE0x02, REG0x64 ~ REG0x67, pls use following way.

TI Information – Selective Disclosure

Bin File Making XVIII | Add Below Selected Command

TI Information – Selective Disclosure

Bin File Making XIX | Add above Selected Command

TI Information – Selective Disclosure

Bin File Making XX | Delete Command

Command 2 is deleted and
command 3 is moved up as
command 2

TI Information – Selective Disclosure

Bin File Creation XXI | Save/Save as the Regbin project file ---- jason file

TI Information – Selective Disclosure

Bin File Creation XXII | Export the regbin binary file I

TI Information – Selective Disclosure

Bin File Creation XXII | Export the regbin binary file II

TI Information – Selective Disclosure

Bin File Creation XXIII | Data Validation Before Exporting Binary I

Try creating binary without providing block type for a block

1. The Block with Invalid data is
selected
2. Error message shown with
appropriate error

TI Information – Selective Disclosure

Bin File Making XXIII -- Data Validation Before Exporting Binary II

Try creating binary without providing data or delay

1. The Block with Invalid data is
selected
2. The Command with Invalid
data is selected
3. Error message shown with
appropriate error

TI Information – Selective Disclosure

regbin_parser.exe & parsing-tool.bat I
• Toolset for regbin parsing.

• Operations:
1. Drag the regbin file onto the parsingtool.bat, then release, see the right
picture, tas2563-4amp-reg.bin is
dragged onto the parsing-tool.bat.
2. It will popup a command-line screen, pls
check the output, the left picture next
page shows a successfully parsing
3. The log of regbin file will be generated,
see the right pic next page, tas25634amp-reg.bin.log has already been
generated.
TI Information – Selective Disclosure

32

regbin_parser.exe & parsing-tool.bat II

TI Information – Selective Disclosure

33

Attentions
• The range of input for “TASDEVICE Profile id” depends on the sum of configs in
Regbin file. It begins with 0.
• Don’t forget to restore the related registers after shutdown
• Kcontrol -- “TASDEVICE Profile id” is dynamically created if valid bin file is in the
system; If no regbin file in the system, kcontrol – “TASDEVICE Profile id” won’t
be created;

• No side-effect to the device and code if there still exists “TASDEVICE Profile id”
in mixer_paths.xml.

TI Information – Selective Disclosure

How to use reg-bin file?
• Put the regbin file into /vendor/firmware, /vendor/etc or /lib/firmware, which
location is up to the platform setting
• Three ways to config
1. tinymix or mixer command
tinymix “TASDEVICE Profile id” 0 ---- bypass regbin
tinymix “TASDEVICE Profile id” 1 ---- select config 1 setting
tinymix “TASDEVICE Profile id” 2 ---- select config 2 setting

2. mixer_path.xml
e.g.
<ctl name=“TASDEVICE Profile id” value=”0”/> ---- bypass regbin
<ctl name=“TASDEVICE Profile id” value=“1”/> ---- select config 1 setting

3. Mixer API: mixer_get_ctl_by_name and mixer_ctl_set_value
TI Information – Selective Disclosure

Case I – Swap channels On Project J20C
• Conf 1 – device 1 is left
channel, device 2 is
right channel

• Conf 2 – device 1 is
right channel, device 2
is left channel
• In this case, the
switching among conf
0, 1 and 2 by mixer
path.
TI Information – Selective Disclosure

J20C

Case 2 -- GREG and PRAM check on factorytest
• Conf 1 – GREG check

• Conf 2 – PRAM check

test_screening

• some register setting will be restored
during post-shutdown

• the switching among conf 0, 1 and 2
by mixer API.

TI Information – Selective Disclosure

tas256x_reg.bin

Case 3 -- floor noise in receiver mode
• Conf 2 – receiver mode

• some register setting will be restored
during post-shutdown
• the switching among conf 0 ~ 2 by
mixer API or mixer_path.xml.

TI Information – Selective Disclosure

To be Improved I -- bin file
• Problem: So far the bin file uses id number to index different conf/profile. If a
new conf/profile has been inserted into the bin file. The id of some confs/profiles
will be changed. The related code will be changed too.
• Solution: Add a 16-byte field for each conf/profile to store the conf name, eg,
Music, Ringtone, Factory Test, Bypass, etc. And the code can index specific
conf by conf name. The code won’t care the order of confs or the number of the
conf.

TI Information – Selective Disclosure

To be Improved II – Bin Tool
• If only Bin Tool would load the reg bin file directly. Currently, using JSON file
load the setting. If no JSON file, we have to remake the bin file first.

TI Information – Selective Disclosure

How to parse the regbin binary file?
• Tool: parsing-tool.bat &
regbin_parser.exe
• Operation Step:
1. Confirm parsing-tool.bat &
regbin_parser.exe are in the same
folder
2. Drag the regbin binary file on the
parsing-tool.bat, then release
3. The log of regbin binary file will be
generated. See pic in the left.

TI Information – Selective Disclosure

41

Appendix I
If the file object can’t be
opened, pls search the file
into %tmp%，see the
following picture.

TI Information – Selective Disclosure

42

Appendix II

TI Information – Selective Disclosure

43

Appendix III

TI Information – Selective Disclosure

44

Appendix IV | How to generate bin file from Jason file I
• Sometime Jason file is
offered with the code, so
conversion from Jason file
to bin file is the mandatory
job.

• STEP I: see the right pic.

TI Information – Selective Disclosure

45

Appendix V | How to generate bin file from Jason file II
• STEP II: Select Jason file
to be imported. See the
right pic.

TI Information – Selective Disclosure

46

Appendix VI | How to generate bin file from Jason file III
• STEP III: Click the “Next”
button. See the right pic.

TI Information – Selective Disclosure

47

Appendix VII | How to generate bin file from Jason file IV
• STEP IV: Click the
“Browse” button to select a
folder to save bin file. See
the right pic.

TI Information – Selective Disclosure

48

Appendix VIII | How to generate bin file from Jason file V
• STEP V: Click the “OK”
button, after the folder to
save bin file is selected.
See the right pic.

TI Information – Selective Disclosure

49

Appendix IX | How to generate bin file from Jason file VI
• STEP VI:
A. Fill the bin file name to be
generated
B. Click the "Generate
Binary" button.

TI Information – Selective Disclosure

50

Appendix X | How to generate bin file from Jason file VII
• STEP VII: if pop-up balloon
occurs like the right pic, the
bin file can be found in the
selected folder.

TI Information – Selective Disclosure

51

Q&A

TI Information – Selective Disclosure

Thank you!

TI Information – Selective Disclosure

53
1/3/2024

